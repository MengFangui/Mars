(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{236:function(t,e,s){"use strict";s.r(e);var a=s(2),v=Object(a.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"_0-3-x-迁移指南"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_0-3-x-迁移指南","aria-hidden":"true"}},[t._v("#")]),t._v(" 0.3.x 迁移指南")]),t._v(" "),s("h2",{attrs:{id:"what-s-new"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#what-s-new","aria-hidden":"true"}},[t._v("#")]),t._v(" What's new")]),t._v(" "),s("p",[s("code",[t._v("0.3.x")]),t._v(" 版本最主要的更新是去掉运行时中 Vue 渲染和更新过程生成 VNode 和 patch 的过程，使得运行时无需创建 VNode 以及进行 VNode 的 DIFF，从而大幅提升了运行时性能，因为去除了 VNode，也简化了 Vue 的 render 函数，从而减小了包大小。对于 H5 的构建流程和运行时架构也进行了简化和重构，便于扩展新的功能。")]),t._v(" "),s("p",[t._v("其他的更新或 Bug 修复：")]),t._v(" "),s("h3",{attrs:{id:"features"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#features","aria-hidden":"true"}},[t._v("#")]),t._v(" Features")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("core:")]),t._v(" 支持从 "),s("code",[t._v("@marsjs/core")]),t._v(" 导出 "),s("code",[t._v("$platform")]),t._v("/"),s("code",[t._v("config")])]),t._v(" "),s("li",[s("strong",[t._v("core:")]),t._v(" 支持通过运行时 "),s("code",[t._v("config")]),t._v(" 配置 H5 路由 "),s("code",[t._v("mode")]),t._v("/"),s("code",[t._v("base")])]),t._v(" "),s("li",[s("strong",[t._v("core:")]),t._v(" 增加 TypeScript 类型定义")]),t._v(" "),s("li",[s("strong",[t._v("build:")]),t._v(" 组件名支持 PascalCase")]),t._v(" "),s("li",[s("strong",[t._v("build:")]),t._v(" 模版中支持使用模版字符串")]),t._v(" "),s("li",[s("strong",[t._v("build:")]),t._v(" 引入 SFC 组件时，支持 "),s("code",[t._v("*.vue")]),t._v(" 后缀写法")]),t._v(" "),s("li",[s("strong",[t._v("build:")]),t._v(" SFC script 导出支持 "),s("code",[t._v("Vue.extend()")]),t._v(" 写法")]),t._v(" "),s("li",[s("strong",[t._v("cli & cli-template:")]),t._v(" 支持跳过 Mars 编译用直接 serve H5 dest 目录")])]),t._v(" "),s("h3",{attrs:{id:"bug-fixes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bug-fixes","aria-hidden":"true"}},[t._v("#")]),t._v(" Bug Fixes")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("build:")]),t._v(" 修复 v-for 中的过滤器和复杂表达式取值错误")]),t._v(" "),s("li",[s("strong",[t._v("build:")]),t._v(" 修复 v-on 中事件参数绑定 scoped 变量错误")]),t._v(" "),s("li",[s("strong",[t._v("build:")]),t._v(" 修复 config 合并策略")]),t._v(" "),s("li",[s("strong",[t._v("cli & cli-template:")]),t._v(" 修复 serve 自定义 H5 dest 目录时 path 错误")])]),t._v(" "),s("h2",{attrs:{id:"是否兼容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#是否兼容","aria-hidden":"true"}},[t._v("#")]),t._v(" 是否兼容")]),t._v(" "),s("p",[s("code",[t._v("0.3.x")]),t._v(" 版本与 "),s("code",[t._v("0.2.x")]),t._v(" 版本在开发规范层面完全兼容，但是由于 "),s("code",[t._v("0.3.x")]),t._v(" 重构了运行时，在一些功能特性上有较小的差异和注意点需要检查。")]),t._v(" "),s("p",[t._v("1、computed")]),t._v(" "),s("p",[s("code",[t._v("0.2.x")]),t._v(" 版本为了优化小程序初始渲染时能获取到 computed 值，进行了一些变通的处理，因为这些处理方法依赖预先创建完整的 Vue 组件树，以及会有一些性能开销。在 "),s("code",[t._v("0.3.x")]),t._v(" 中，我们移除了对 computed 值的特殊处理，你需要检查是否依赖 computed 值的初始获取。")]),t._v(" "),s("p",[t._v("2、小程序 attached 生命周期")]),t._v(" "),s("p",[s("code",[t._v("0.3.x")]),t._v(" 中组件对应的 vue 实例创建时机统一到小程序的 "),s("code",[t._v("lifetimes.attached")]),t._v(" 生命周期，导致在 swan 的 lifetimes.created 生命周期中将无法通过 this 获取到 vue 实例，"),s("code",[t._v("lifetimes.created")]),t._v(" 中 "),s("code",[t._v("this")]),t._v(" 中仅可以访问 "),s("code",[t._v("$api")]),t._v(" 和 "),s("code",[t._v("$mp.scope")]),t._v(" （指向小程序组件实例）属性。如果有在 "),s("code",[t._v("lifetimes.created")]),t._v(" 生命周期中通过 "),s("code",[t._v("this")]),t._v(" 获取和操作 vue 实例，需要将逻辑迁移至小程序的 "),s("code",[t._v("lifetimes.attached")]),t._v(" 或者 vue 的 "),s("code",[t._v("created")]),t._v(" 生命周期。")]),t._v(" "),s("p",[t._v("3、事件绑定参数传递")]),t._v(" "),s("p",[s("code",[t._v("0.3.x")]),t._v(" 在事件绑定中绑定参数时，"),s("code",[t._v("$event")]),t._v(" 参数只支持作为单独的参数绑定，不支持将 "),s("code",[t._v("$event")]),t._v(" 放在数组或对象字面量中。例如：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 支持 --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Component")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@change")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("handle($event, otherArg, {otherArg})"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!-- 不支持 将获取不到 $event --\x3e")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Component")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@change")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("handle({$event, otherArg}, otherArg)"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n")])])]),s("p",[t._v("4、npm 引入的 UI 组件库以及组件库作者")]),t._v(" "),s("p",[t._v("如果有使用 npm 引入的 UI 组件库，需要将组件库中的 Mars 框架升级到 "),s("code",[t._v("0.3.x")]),t._v(" 并发布新版本。")]),t._v(" "),s("h2",{attrs:{id:"如何迁移"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何迁移","aria-hidden":"true"}},[t._v("#")]),t._v(" 如何迁移")]),t._v(" "),s("p",[t._v("1、新建项目并转移业务代码")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 0.3.x mars-cli")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" -g @marsjs/cli@next\n")])])]),s("p",[t._v("安装 "),s("code",[t._v("0.3.x")]),t._v(" 版本的 "),s("code",[t._v("@marsjs/cli")]),t._v("，创建一个新项目，然后将业务代码和配置文件合并转移到项目中。")]),t._v(" "),s("p",[t._v("2、从现有项目迁移")]),t._v(" "),s("div",{staticClass:"language-sh extra-class"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 0.3.x 依赖包, 非 H5 项目")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" @marsjs/cli@next @marsjs/cli-build@next @marsjs/cli-core@next -D\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装 0.3.x 依赖包, H5 项目")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" @marsjs/cli@next @marsjs/cli-core@next @marsjs/cli-build@next @marsjs/cli-template@next -D\n\n")])])]),s("ul",[s("li",[t._v("升级全局和本地安装的 "),s("code",[t._v("@marsjs/cli")]),t._v(" 版本到 "),s("code",[t._v("0.3.x")])]),t._v(" "),s("li",[t._v("升级本地的 "),s("code",[t._v("@marsjs/core")]),t._v(" "),s("code",[t._v("@marsjs/build")]),t._v(" 版本到 "),s("code",[t._v("0.3.x")])]),t._v(" "),s("li",[t._v("升级本地的 "),s("code",[t._v("@marsjs/cli-template")]),t._v(" 版本到 "),s("code",[t._v("0.3.x")]),t._v(" （H5 项目）")])])])},[],!1,null,null,null);e.default=v.exports}}]);